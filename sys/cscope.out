cscope 15 $HOME/os_course_proj/sys               0000069863
	@elf64.c

1 
	~<sys/ñf64.h
>

2 
	~<sys/defs.h
>

3 
	~<sys/gdt.h
>

4 
	~<sys/k¥ötf.h
>

5 
	~<sys/èrfs.h
>

6 
	~<sys/idt.h
>

7 
	~<sys/∑gög.h
>

8 
	~<sys/∑gög_hñ≥r.h
>

9 
	~<sys/¥o˚ss.h
>

11 
èrfûe_t
 
globÆ_èrfs
[100];

13 
	$ñf_check_hódî
(
Elf64_Ehdr
 *
ñfhdr
) {

14 i‡(! 
ñfhdr
) {

17 i‡(
ñfhdr
->
e_idít
[
EI_MAG0
] !
ELFMAG0
) {

18 
	`k¥ötf
("ELF Header EI_MAG0 incorrect \n");

21 i‡(
ñfhdr
->
e_idít
[
EI_MAG1
] !
ELFMAG1
) {

22 
	`k¥ötf
("ELF Header EI_MAG1 incorrect \n");

25 i‡(
ñfhdr
->
e_idít
[
EI_MAG2
] !
ELFMAG2
) {

26 
	`k¥ötf
("ELF Header EI_MAG2 incorrect \n");

29 i‡(
ñfhdr
->
e_idít
[
EI_MAG3
] !
ELFMAG3
) {

30 
	`k¥ötf
("ELF Header EI_MAG3 incorrect \n");

35 
	}
}

37 
	$lﬂd_bö¨õs
(
Â
, 
mm_°ru˘_t
 *
mm
) {

38 
Elf64_Ehdr
 *
ñf_hdr
;

39 
Elf64_Phdr
 *
ñf_phdr
;

40 
i
 = 0;

42 
p_Êags
 = 0;

43 
ªt_vÆ
 = 0;

44 
uöt64_t
 
phdr_íd
 = 0;

47 
ñf_hdr
 = (
Elf64_Ehdr
 *)
globÆ_èrfs
[
Â
].
addr
;

49 i‡(!
	`ñf_check_hódî
(
ñf_hdr
)) {

53 
	`k¥ötf
("ñf_hdr: %d\n",
ñf_hdr
->
e_íåy
);

54 
mm
->
rù
 = (
uöt64_t
)
ñf_hdr
->
e_íåy
;

56 
i
 = 0; i < 
ñf_hdr
->
e_phnum
; i++) {

57 
ñf_phdr
 = (
Elf64_Phdr
 *)((
uöt64_t
)
ñf_hdr
 +Élf_hdr->
e_phoff
Ë+ 
i
;

58 i‡(
ñf_phdr
->
p_ty≥
 =
PT_LOAD
) {

60 
p_Êags
 = (
ñf_phdr
->p_Êag†& 
PF_W
Ë? 
RW_FLAG
: 0;

61 
pdhr_íd
 = 
ñf_phdr
->
p_vaddr
 + 
p_memsz
;

62 
ªt_vÆ
 = 
	`mm≠_Æloc
(
mm
, 
Â
, 
ñf_phdr
->
p_off£t
,Élf_phdr->
p_fûesz
,Élf_phdr->
p_vaddr
, 
phdr_íd
, 
p_Êags
);

63 i‡(
ªt_vÆ
 == -1) {

64 
	`k¥ötf
("Memory Allocation failed\n");

65  
ªt_vÆ
;

71 
	}
}

	@gdt.c

1 
	~<sys/defs.h
>

2 
	~<sys/gdt.h
>

6 
	#GDT_CS
 (0x00180000000000Ë

	)

7 
	#GDT_DS
 (0x00100000000000Ë

	)

9 
	#C
 (0x00040000000000Ë

	)

10 
	#DPL0
 (0x00000000000000Ë

	)

11 
	#DPL1
 (0x00200000000000Ë

	)

12 
	#DPL2
 (0x00400000000000Ë

	)

13 
	#DPL3
 (0x00600000000000Ë

	)

14 
	#P
 (0x00800000000000Ë

	)

15 
	#L
 (0x20000000000000Ë

	)

16 
	#D
 (0x40000000000000Ë

	)

17 
	#W
 (0x00020000000000Ë

	)

19 
	#MAX_GDT
 32

	)

21 
	stss_t
 {

22 
uöt32_t
 
	mª£rved_0
;

23 *
	mr•0
;

24 *
	mr•1
;

25 *
	mr•2
;

26 
uöt64_t
 
	mª£rved_1
;

27 *
	mi°1
;

28 *
	mi°2
;

29 *
	mi°3
;

30 *
	mi°4
;

31 *
	mi°5
;

32 *
	mi°6
;

33 *
	mi°7
;

34 
uöt64_t
 
	mª£rved_2
;

35 
uöt16_t
 
	mª£rved_3
;

36 
uöt16_t
 
	miom≠_ba£
;

37 }
__©åibuã__
((
∑cked
));

39 
	ssys_£gmít_des¸ùt‹
 {

40 
uöt64_t
 
	msd_lﬁimô
 :16;

41 
uöt64_t
 
	msd_loba£
 :24;

42 
uöt64_t
 
	msd_ty≥
 :5;

43 
uöt64_t
 
	msd_d∂
 :2;

44 
uöt64_t
 
	msd_p
 :1;

45 
uöt64_t
 
	msd_hûimô
 :4;

46 
uöt64_t
 
	msd_xx1
 :3;

47 
uöt64_t
 
	msd_gøn
 :1;

48 
uöt64_t
 
	msd_hiba£
 :40;

49 
uöt64_t
 
	msd_xx2
 :8;

50 
uöt64_t
 
	msd_zîo
 :5;

51 
uöt64_t
 
	msd_xx3
 :19;

52 }
__©åibuã__
((
∑cked
));

54 
	sgdå_t
 {

55 
uöt16_t
 
	msize
;

56 
uöt64_t
 
	maddr
;

57 }
__©åibuã__
((
∑cked
));

59 
uöt64_t
 
	ggdt
[
MAX_GDT
] = {

61 
GDT_CS
 | 
P
 | 
DPL0
 | 
L
,

62 
GDT_DS
 | 
P
 | 
W
 | 
DPL0
,

64 
GDT_DS
 | 
P
 | 
W
 | 
DPL3
,

65 
GDT_CS
 | 
P
 | 
DPL3
 | 
L
,

68 
gdå_t
 
	ggdå
 = { (
gdt
), (
uöt64_t
)gdt };

69 
tss_t
 
	gtss
;

71 
_x86_64_asm_lgdt
(
gdå_t
 *
gdå
, 
uöt64_t
 
cs_idx
, uöt64_à
ds_idx
);

72 
_x86_64_asm_…r
(
uöt64_t
 
tss_idx
);

73 
	$öô_gdt
() {

74 
sys_£gmít_des¸ùt‹
 *
sd
 = (sys_£gmít_des¸ùt‹*)&
gdt
[6];

75 
sd
->
sd_lﬁimô
 = (
tss_t
) - 1;

76 
sd
->
sd_loba£
 = ((
uöt64_t
)&
tss
);

77 
sd
->
sd_ty≥
 = 9;

78 
sd
->
sd_d∂
 = 0;

79 
sd
->
sd_p
 = 1;

80 
sd
->
sd_hûimô
 = 0;

81 
sd
->
sd_gøn
 = 0;

82 
sd
->
sd_hiba£
 = ((
uöt64_t
)&
tss
) >> 24;

84 
	`_x86_64_asm_lgdt
(&
gdå
, 8, 16);

85 
	`_x86_64_asm_…r
(0x30);

86 
	}
}

88 
	$£t_tss_r•
(*
r•
) {

89 
tss
.
r•0
 = 
r•
;

90 
	}
}

	@idt.c

1 
	~<sys/idt.h
>

2 
	~<sys/k¥ötf.h
>

3 
	~<sys/defs.h
>

5 
idt_íåy
 
	gíåõs
[256];

6 
idt_±r
 
	gidç
;

9 
idt_lﬂd
();

11 
	$£t_idt_g©e
(
uöt8_t
 
num
,
uöt64_t
 
ba£_addr
, 
uöt16_t
 
£l
, uöt8_à
g©e
 ){

12 
íåõs
[
num
].
addr_low
 = 
ba£_addr
 & 0xFFFF;

13 
íåõs
[
num
].
addr_mid
 = (
ba£_addr
 >> 16 ) & 0xFFFF;

14 
íåõs
[
num
].
addr_high
 = (
ba£_addr
 >>32) & 0xFFFFFFFF;

15 
íåõs
[
num
].
£À˘‹
 = 
£l
;

16 
íåõs
[
num
].
Æways0
 = 0;

17 
íåõs
[
num
].
Êags
 = 
g©e
;

18 
	}
}

20 
	$öô_idt
(){

21 
idç
.
limô
 = (
idt_íåy
Ë* 
INTERRUPT_LIMIT
 - 1;

22 
idç
.
ba£_addr
 = (
uöt64_t
Ë&
íåõs
;

25 
	`idt_lﬂd
();

26 
	}
}

	@kb.c

7 
	~<sys/k¥ötf.h
>

8 
	~<sys/pic.h
>

9 
	~<sys/piˇs£m.h
>

10 
	~<sys/idt.h
>

11 
	~<sys/kb.h
>

14 
	#KB_DATA_PORT
 0x60

	)

15 
	#KB_STATUS_PORT
 0x64

	)

17 
	gc⁄åﬁ
 = 0;

18 
	gshi·
 = 0;

20 
	gkeybﬂrd_m≠
[128] =

60 
	gkeybﬂrd_uµî_m≠
[] =

76 
	$kb_h™dÀr
(
ªgis
 *
s
) {

77 
°©us
;

78 
sˇncode
;

81 
	`outb
(0x20, 0x20);

83 
°©us
 = 
	`öb
(
KB_STATUS_PORT
);

85 i‡(
°©us
 & 0x01) {

86 
sˇncode
 = 
	`öb
(
KB_DATA_PORT
);

87 i‡(
sˇncode
 < 0) {

90 i‡(
sˇncode
 == 0x2A || scancode == 0x36) {

92 
shi·
 = 1;

95 i‡(
sˇncode
 == 0xAA || scancode == 0xB6) {

97 
shi·
 = 0;

100 i‡(
sˇncode
 == 0x1D) {

102 
c⁄åﬁ
 = 1;

105 if(
sˇncode
 == 0x9D) {

107 
c⁄åﬁ
 = 0;

110 if(
sˇncode
 == 0x48) {

112 
c⁄åﬁ
 = 1;

113 
shi·
 = 1;

114 
	`k¥ötf_kb
(0x48);

115 
c⁄åﬁ
 = 0;

116 
shi·
 = 0;

119 if(
sˇncode
 == 0x4B) {

121 
c⁄åﬁ
 = 1;

122 
shi·
 = 1;

123 
	`k¥ötf_kb
(0x4B);

124 
c⁄åﬁ
 = 0;

125 
shi·
 = 0;

128 if(
sˇncode
 == 0x50) {

130 
c⁄åﬁ
 = 1;

131 
shi·
 = 1;

132 
	`k¥ötf_kb
(0x50);

133 
c⁄åﬁ
 = 0;

134 
shi·
 = 0;

137 if(
sˇncode
 == 0x4D) {

139 
c⁄åﬁ
 = 1;

140 
shi·
 = 1;

141 
	`k¥ötf_kb
(0x4D);

142 
c⁄åﬁ
 = 0;

143 
shi·
 = 0;

146 i‡(
sˇncode
 == 0x0E) {

148 
c⁄åﬁ
 = 1;

149 
	`k¥ötf_kb
('h');

150 
c⁄åﬁ
 = 0;

153 i‡(
sˇncode
 == 0x53) {

155 
c⁄åﬁ
 = 1;

156 
	`k¥ötf_kb
('?');

157 
c⁄åﬁ
 = 0;

160 i‡(
sˇncode
 > 127) {

163 i‡(
shi·
 =1 || 
c⁄åﬁ
 == 1) {

165 
°©us
 = 
keybﬂrd_uµî_m≠
[()
sˇncode
];

166 
	`k¥ötf_kb
(
°©us
);

169 } i‡(
c⁄åﬁ
 == 1) {

172 
°©us
 = 
keybﬂrd_m≠
[()
sˇncode
];

173 i‡(
°©us
 == 'c') {

174 
	`k¥ötf_kb
(30);

175 } i‡(
°©us
 == 'z') {

176 
	`k¥ötf_kb
(31);

178 
c⁄åﬁ
 = 0;

181 
°©us
 = 
keybﬂrd_m≠
[()
sˇncode
];

186 
	`k¥ötf_kb
(
°©us
);

190 
	}
}

193 
	$kb_öô
() {

194 
	`outb
(0x21 , 0xFC);

195 
	`úq_£t
(1, 
kb_h™dÀr
);

196 
	}
}

	@kprintf.c

1 
	~<sys/k¥ötf.h
>

2 
	~<°d¨g.h
>

3 
	~<sys/defs.h
>

4 
	~<sys/kb.h
>

5 
	~<sys/∑gög.h
>

7 vﬁ©ûê*
	gvideo
 = ( *)
VIDEO_ADDR
;

8 
	gcﬁour
= 7;

10 
	gx_pos
 = 0;

11 
	gy_pos
 = 0;

12 
	gc⁄åﬁ
;

13 
	gshi·
;

15 
	$°πoöt
 (
num
, 
°r
[])

17 
i
 = 0;

19 i‡(
num
 > 9)

21 
i
 = 0;

22 
	`°πoöt
 (
num
 / 10, 
°r
);

23 
°r
[
i
] != '\0')

25 
i
++;

27 
°r
[
i
++] = ()(
num
 % 10) + '0';

28 
°r
[
i
] = '\0';

30 if(
num
 == 0) {

31 
°r
[0] = '0';

32 
°r
[1] = '\0';

36 
i
 = 0;

37 
°r
[
i
] != '\0')

39 
i
++;

41 
°r
[
i
++] = ()
num
 + '0';

42 
°r
[
i
] = '\0';

45 
	}
}

47 
	$c⁄vîtHex2Såög
(
n
, 
°r
[]){

48 * 
°rög
 = 
NULL
;

49 
i
 = 0;

50 
j
 = 0;

52 
n
 >0){

53 
ªm1
 = 
n
 %16;

54 
div
 = 
n
/16;

55 if(
ªm1
 >= 0 &&Ñem1 <= 9){

56 
°rög
[
i
] = (Ë(
ªm1
 + '0');

58 
ªm1
 -= 10;

59 
°rög
[
i
] = (Ë(
ªm1
 + 'A');

61 
n
 = 
div
;

62 
i
++;

64 
i
--;

65 
j
 = 2;

66 
°r
[0] = '0';

67 
°r
[1] = 'x';

68 
i
 >= 0 ){

69 
°r
[
j
++] = 
°rög
[
i
--];

71 
°r
[
j
] = '\0';

73 
	}
}

76 
	$c⁄vîtPoöãrAddªss2Såög
(
n
, 
°r
[]){

77 *
°rög2
 = 
NULL
;

78 
i
 =0;

79 
n
 >0){

80 
ªm1
 = 
n
 %16;

81 
div
 = 
n
/16;

82 if(
ªm1
 >= 0 &&Ñem1 <= 9){

83 
°rög2
[
i
] = (Ë(
ªm1
 + '0');

85 
ªm1
 -= 10;

86 
°rög2
[
i
] = (Ë(
ªm1
 + 'A');

88 
n
 = 
div
;

89 
i
++;

91 
i
--;

92 
j
 =2;

93 
°r
[0] = '0';

94 
°r
[1] = 'x';

95 
i
 >= 0 ){

96 
°r
[
j
++] = 
°rög2
[
i
--];

98 
°r
[
j
] = '\0';

99 
i
 = 0;

100 
°r
[
i
] != '\0') {

101 
i
++;

103 i‡(
i
 == 2) {

104 
°r
[
i
++] = '0';

105 
°r
[
i
] = '\0';

108 
	}
}

111 
	$upd©e_s¸ìn
() {

112 
x
 = 0;

113 
y
 = 0;

114 *
mem_loc
 = (*)0xB8000;

116 
x
 = 0; x < 160; x++) {

117 
y
 = 0; y < 24; y++) {

118 
mem_loc
[
x
 + (
y
*160)] = mem_loc[x + ((y+1)*160)];

119 
mem_loc
[
x
 + (
y
*160)] = mem_loc[x + ((y+1)*160)];

122 
	}
}

125 
	$k¥ötf
(*
°rög
, ...)

127 
va_li°
 
li°
;

128 
	`va_°¨t
(
li°
, 
°rög
);

129 
ch¨_vÆ
;

130 
öt_vÆ
 = 0;

131 *
°r_vÆ
 = 
NULL
;

132 
°r
[50];

133 
i
 = 0;

134 
l⁄g_vÆ
 = 0;

135  *
°rög
 != '\0')

137 *
°rög
 != '%' && *string != '\0') {

138 i‡(*
°rög
 == '\n') {

139 
y_pos
 ++;

140 
x_pos
 = 0;

141 
°rög
 ++;

142 i‡(
y_pos
 == 24) {

143 
	`upd©e_s¸ìn
();

144 
y_pos
 --;

147 i‡(*
°rög
 == '\r') {

148 
x_pos
 = 0;

149 
°rög
 ++;

151 i‡(
x_pos
 == 160) {

152 
x_pos
 = 0;

153 
y_pos
 ++;

155 i‡(
y_pos
 == 24) {

156 
	`upd©e_s¸ìn
();

157 
y_pos
 --;

159 
video
[
x_pos
++ + (
y_pos
*160)] = *
°rög
++;

160 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

163 i‡(*
°rög
 == '%') {

164 
°rög
++;

165 *
°rög
) {

167 
ch¨_vÆ
 = 
	`va_¨g
(
li°
, );

168 i‡(
x_pos
 == 160) {

169 
x_pos
 = 0;

170 
y_pos
 ++;

171 i‡(
y_pos
 == 24) {

172 
	`upd©e_s¸ìn
();

173 
y_pos
 --;

179 i‡(
ch¨_vÆ
 != '\n') {

180 
video
[
x_pos
++ + (
y_pos
*160)] = 
ch¨_vÆ
;

181 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

183 
y_pos
 ++;

184 
x_pos
 = 0;

185 i‡(
y_pos
 == 24) {

186 
	`upd©e_s¸ìn
();

187 
y_pos
 --;

192 
°r_vÆ
 = 
	`va_¨g
(
li°
, *);

193 *
°r_vÆ
 != '\0') {

194 i‡(
x_pos
 == 160) {

195 
x_pos
 = 0;

196 
y_pos
 ++;

198 i‡(
y_pos
 == 24) {

199 
	`upd©e_s¸ìn
();

200 
y_pos
 --;

202 
video
[
x_pos
++ + (
y_pos
*160)] = *
°r_vÆ
++;

203 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

207 
öt_vÆ
 = 
	`va_¨g
(
li°
, );

208 
i
 = 0;

209 
°r
[
i
] != '\0') {

210 
°r
[
i
++] = '\0';

212 
i
 = 0;

213 
	`°πoöt
(
öt_vÆ
, 
°r
);

214 
°r
[
i
] != '\0') {

215 i‡(
x_pos
 == 160) {

216 
x_pos
 = 0;

217 
y_pos
 ++;

219 i‡(
y_pos
 == 24) {

220 
	`upd©e_s¸ìn
();

221 
y_pos
 --;

223 
video
[
x_pos
++ + (
y_pos
*160)] = 
°r
[
i
++];

224 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

228 
öt_vÆ
 = 
	`va_¨g
(
li°
, );

229 
i
 = 0;

230 
	`c⁄vîtHex2Såög
(
öt_vÆ
, 
°r
);

231 
°r
[
i
] != '\0') {

232 i‡(
x_pos
 == 160) {

233 
x_pos
 = 0;

234 
y_pos
 ++;

236 i‡(
y_pos
 == 24) {

237 
	`upd©e_s¸ìn
();

238 
y_pos
 --;

240 
video
[
x_pos
++ + (
y_pos
*160)] = 
°r
[
i
++];

241 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

245 
l⁄g_vÆ
 = ()
	`va_¨g
(
li°
, );

246 
	`c⁄vîtPoöãrAddªss2Såög
(
l⁄g_vÆ
, 
°r
);

247 
i
 = 0;

248 
°r
[
i
] != '\0') {

249 i‡(
x_pos
 == 160) {

250 
x_pos
 = 0;

251 
y_pos
 ++;

253 i‡(
y_pos
 == 24) {

254 
	`upd©e_s¸ìn
();

255 
y_pos
 --;

257 
video
[
x_pos
++ + (
y_pos
*160)] = 
°r
[
i
++];

258 
video
[
x_pos
++ + (
y_pos
*160)] = 
cﬁour
;

265 
°rög
++;

269 
	}
}

272 
	$k¥ötf_kb
(
ch
) {

273 
x
 = 80;

275 i‡(
ch
 == '\n') {

276 
video
[
x
++ + (24 * 160)] = '^';

277 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

278 
video
[
x
++ + (24 * 160)] = 'M';

279 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

280 
video
[
x
++ + (24 * 160)] = ' ';

281 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

282 
video
[
x
++ + (24 * 160)] = ' ';

283 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

285 i‡(
c⁄åﬁ
 == 1) {

286 i‡(
ch
 =0x48 && 
shi·
 == 1) {

288 
video
[
x
++ + (24 * 160)] = '^';

289 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

290 
video
[
x
++ + (24 * 160)] = '[';

291 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

292 
video
[
x
++ + (24 * 160)] = '[';

293 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

294 
video
[
x
++ + (24 * 160)] = 'A';

295 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

297 if(
ch
 =0x4B && 
shi·
 == 1) {

299 
video
[
x
++ + (24 * 160)] = '^';

300 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

301 
video
[
x
++ + (24 * 160)] = '[';

302 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

303 
video
[
x
++ + (24 * 160)] = '[';

304 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

305 
video
[
x
++ + (24 * 160)] = 'D';

306 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

308 i‡(
ch
 =0x4D && 
shi·
 == 1) {

310 
video
[
x
++ + (24 * 160)] = '^';

311 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

312 
video
[
x
++ + (24 * 160)] = '[';

313 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

314 
video
[
x
++ + (24 * 160)] = '[';

315 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

316 
video
[
x
++ + (24 * 160)] = 'C';

317 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

319 i‡(
ch
 =0x50 && 
shi·
 == 1) {

321 
video
[
x
++ + (24 * 160)] = '^';

322 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

323 
video
[
x
++ + (24 * 160)] = '[';

324 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

325 
video
[
x
++ + (24 * 160)] = '[';

326 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

327 
video
[
x
++ + (24 * 160)] = 'B';

328 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

330 i‡(
ch
 == 0x68) {

332 
video
[
x
++ + (24 * 160)] = '^';

333 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

334 
video
[
x
++ + (24 * 160)] = 'H';

335 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

336 
video
[
x
++ + (24 * 160)] = ' ';

337 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

338 
video
[
x
++ + (24 * 160)] = ' ';

339 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

343 
video
[
x
++ + (24 * 160)] = '^';

344 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

345 
video
[
x
++ + (24 * 160)] = 
ch
;

346 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

347 
video
[
x
++ + (24 * 160)] = ' ';

348 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

349 
video
[
x
++ + (24 * 160)] = ' ';

350 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

354 i‡(
ch
 == 30) {

355 
video
[
x
++ + (24 * 160)] = '^';

356 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

357 
video
[
x
++ + (24 * 160)] = 'C';

358 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

360 i‡(
ch
 == 31) {

361 
video
[
x
++ + (24 * 160)] = '^';

362 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

363 
video
[
x
++ + (24 * 160)] = 'Z';

364 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

368 
video
[
x
++ + (24 * 160)] = 
ch
;

369 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

370 
video
[
x
++ + (24 * 160)] = ' ';

371 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

372 
video
[
x
++ + (24 * 160)] = ' ';

373 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

374 
video
[
x
++ + (24 * 160)] = ' ';

375 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

379 
	}
}

382 
	$k¥ötf_timî
(
time
) {

383 
hr
 = 0;

384 
mös
 = 0;

385 
£cs
 = 0;

386 vﬁ©ûê
x
 = 110;

387 
i
 = 0;

388 *
°r
 = "Time since boot: ";

389 
°r_t
[50];

391 
hr
 = 
time
 / 3600;

392 
time
 =Åime % 3600;

393 
mös
 = 
time
 / 60;

394 
£cs
 = 
time
 % 60;

397 *
°r
 != '\0') {

398 
video
[
x
++ + (24 * 160)] = *
°r
++;

399 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

403 
°r_t
[
i
] != '\0') {

404 
°r_t
[
i
++] = '\0';

406 
i
 = 0;

407 
	`°πoöt
(
hr
, 
°r_t
);

408 
°r_t
[
i
] != '\0') {

409 
video
[
x
++ + (24 * 160)] = 
°r_t
[
i
++];

410 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

412 
video
[
x
++ + (24 * 160)] = ':';

413 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

417 
i
 = 0;

418 
°r_t
[
i
] != '\0') {

419 
°r_t
[
i
++] = '\0';

421 
i
 = 0;

422 
	`°πoöt
(
mös
, 
°r_t
);

423 
°r_t
[
i
] != '\0') {

424 
video
[
x
++ + (24 * 160)] = 
°r_t
[
i
++];

425 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

427 
video
[
x
++ + (24 * 160)] = ':';

428 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

431 
i
 = 0;

432 
°r_t
[
i
] != '\0') {

433 
°r_t
[
i
++] = '\0';

435 
i
 = 0;

436 
	`°πoöt
(
£cs
, 
°r_t
);

437 
°r_t
[
i
] != '\0') {

438 
video
[
x
++ + (24 * 160)] = 
°r_t
[
i
++];

439 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

441 
x
 <=160) {

442 
video
[
x
++ + (24 * 160)] = ' ';

443 
video
[
x
++ + (24 * 160)] = 
cﬁour
;

446 
	}
}

	@kprintf_1.c

2 
	~<sys/k¥ötf.h
>

3 
	~<°d¨g.h
>

4 
	~<sys/defs.h
>

6 vﬁ©ûê*
	gvideo
 = ( *)0xB8000;

7 
	gcﬁour
 = 31;

8 
	$©oi
(
num
) {

26 
	}
}

28 
	$c⁄vîtHex2Såög
(
n
){

29 
°rög
[20];

30 * 
°rög2
 = "0x";

31 
i
 =0;

32 
n
 >0){

33 
ªm1
 = 
n
 %16;

34 
div
 = 
n
/16;

35 if(
ªm1
 >= 0 &&Ñem1 <= 9){

36 
°rög
[
i
] = (Ë(
ªm1
 + '0');

38 
ªm1
 -= 10;

39 
°rög
[
i
] = (Ë(
ªm1
 + 'A');

41 
n
 = 
div
;

42 
i
++;

44 
i
--;

45 
j
 =2;

46 
i
 >= 0 ){

47 
°rög2
[
j
++] = 
°rög
[
i
--];

49 
°rög2
[
j
] = '\0';

50 
i
 =0;

51 
°rög2
[
i
] != '\0') {

52 *
video
++ = 
°rög2
[
i
]++;

53 *
video
++ = 
cﬁour
;

54 
i
++;

56 
	}
}

58 
	$c⁄vîtPoöãrAddªss2Såög
(
n
){

59 
°rög
[50];

60 *
°rög2
 = "0x";

61 
i
 =0;

62 
n
 >0){

63 
ªm1
 = 
n
 %16;

64 
div
 = 
n
/16;

65 if(
ªm1
 >= 0 &&Ñem1 <= 9){

66 
°rög
[
i
] = (Ë(
ªm1
 + '0');

68 
ªm1
 -= 10;

69 
°rög
[
i
] = (Ë(
ªm1
 + 'A');

71 
n
 = 
div
;

72 
i
++;

74 
i
--;

75 
j
 =2;

76 
i
 >= 0 ){

77 
°rög2
[
j
++] = 
°rög
[
i
--];

79 
°rög2
[
j
] = '\0';

80 
i
 =0;

81 
°rög2
[
i
] != '\0') {

82 *
video
++ = 
°rög2
[
i
];

83 *
video
++ = 
cﬁour
;

84 
i
++;

86 
	}
}

87 
	$k¥ötf
(c⁄° *
°rög
, ...)

89 
va_li°
 
li°
;

90 
	`va_°¨t
(
li°
, 
°rög
);

93 
ch¨_vÆ
;

94 
öt_vÆ
 = 0;

95 
l⁄g_vÆ
;

96 *
°r_vÆ
 = 
NULL
;

98  *
°rög
 != 0)

100 *
°rög
 != '%') {

101 *
video
++ = *
°rög
++;

102 *
video
++ = 
cﬁour
;

104 
°rög
++;

106 *
°rög
) {

108 
ch¨_vÆ
 = 
	`va_¨g
(
li°
, );

109 *
video
++ = 
ch¨_vÆ
;

110 *
video
++ = 
cﬁour
;

113 
°r_vÆ
 = 
	`va_¨g
(
li°
, *);

114 *
°r_vÆ
 != '\0') {

115 *
video
++ = *
°r_vÆ
++;

116 *
video
++ = 
cﬁour
;

120 
öt_vÆ
 = 
	`va_¨g
(
li°
, );

122 *
°r_vÆ
 != '\0') {

123 *
video
++ = *
°r_vÆ
++;

124 *
video
++ = 
cﬁour
;

128 
l⁄g_vÆ
 = 
	`va_¨g
(
li°
, );

129 
	`c⁄vîtPoöãrAddªss2Såög
(
l⁄g_vÆ
);

132 
öt_vÆ
 = 
	`va_¨g
(
li°
, );

133 
	`c⁄vîtHex2Såög
(
öt_vÆ
);

136 
°rög
++;

140 
	}
}

	@main.c

1 
	~<sys/defs.h
>

2 
	~<sys/gdt.h
>

3 
	~<sys/k¥ötf.h
>

4 
	~<sys/èrfs.h
>

5 
	~<sys/ahci.h
>

6 
	~<sys/idt.h
>

7 
	~<sys/pic.h
>

8 
	~<sys/timî.h
>

9 
	~<sys/kb.h
>

10 
	~<sys/∑gög.h
>

11 
	~<sys/∑gög_hñ≥r.h
>

12 
	~<sys/¥o˚ss.h
>

13 
	~<sys/ñf64.h
>

15 
	#INITIAL_STACK_SIZE
 4096

	)

16 
uöt8_t
 
	göôül_°ack
[
INITIAL_STACK_SIZE
]
__©åibuã__
((
Æig√d
(16)));

17 
uöt32_t
* 
	glﬂdî_°ack
;

18 
kînmem
, 
physba£
;

19 
	gbuf„r
[100];

21 
	$°¨t
(
uöt32_t
 *
moduÀp
, *
physba£
, *
phys‰ì
)

23 
uöt64_t
 
max_size
 = 0;

24 
	ssm≠_t
 {

25 
uöt64_t
 
ba£
, 
Àngth
;

26 
uöt32_t
 
ty≥
;

27 }
	`__©åibuã__
((
∑cked
)Ë*
sm≠
, 
sm≠_max
 = {0};

28 
moduÀp
[0] != 0x9001) modulep += modulep[1]+2;

29 
sm≠
 = (
sm≠_t
*)(
moduÀp
+2); smap < (smap_t*)((*)modulep+modulep[1]+2*4); ++smap) {

30 i‡(
sm≠
->
ty≥
 =1 && sm≠->
Àngth
 != 0) {

31 
	`k¥ötf
("AvaûabÀ Physiˇ»Mem‹y [%p-%p]\n", 
sm≠
->
ba£
, sm≠->
Àngth
);

32 i‡(
sm≠
->
Àngth
 > 
max_size
) {

33 
max_size
 = 
sm≠
->
Àngth
;

34 
sm≠_max
.
ba£
 = 
sm≠
->base;

35 
sm≠_max
.
Àngth
 = 
sm≠
->length;

40 
	`öô_∑gög
((
uöt64_t
)
physba£
, (uöt64_t)
phys‰ì
, 
sm≠_max
.
ba£
, sm≠_max.
Àngth
);

41 
	`k¥ötf
("phys‰ì %p\n", (
uöt64_t
)
phys‰ì
);

42 
	`k¥ötf
("èrf†ö [%p:%p]\n", &
_bö¨y_èrfs_°¨t
, &
_bö¨y_èrfs_íd
);

44 
	`£tup_∑ge_èbÀs
((
uöt64_t
)
physba£
, (uöt64_t)
phys‰ì
);

45 
	`£t_idítôy_∑gög
();

46 
	`lﬂd_CR3
();

47 
	`k¥ötf
("Printingáfter CR3 called");

48 
	`öô_idt
();

50 
	`öô_picúr
();

52 
	`öô_timî
(1000);

53 
	`kb_öô
();

54 
	`k¥ötf
("Printing something\n");

55 
__asm__
 volatile("sti");

56 
uöt64_t
 *
addr
 = (uöt64_à*)
	`kmÆloc
(6000);

57 
	`k¥ötf
("addrs: %d\n",
addr
);

59 
	`öô_èrfs
();

60 
fd
 = 
	`›í
("bin/cat", 2);

61 
	`ªad
(
fd
, 
buf„r
, 100);

63 
mm_°ru˘_t
 *
mm
 = (mm_°ru˘_à*)
	`kmÆloc
();

64 
	`lﬂd_bö¨õs
(
fd
, 
mm
);

72 
	}
}

74 
	$boŸ
()

77 *
ãmp1
, *
ãmp2
;

79 
ãmp2
 = (*)0xb8001;Åemp2 < (*)0xb8000+160*25;Åemp2 += 2) *temp2 = 7 ;

80 
	`__asm__
(

84 :"=g"(
lﬂdî_°ack
)

85 :"r"(&
öôül_°ack
[
INITIAL_STACK_SIZE
])

87 
	`öô_gdt
();

88 
	`°¨t
(

89 (
uöt32_t
*)((*)(
uöt64_t
)
lﬂdî_°ack
[3] + (uöt64_t)&
kînmem
 - (uöt64_t)&
physba£
),

90 (
uöt64_t
*)&
physba£
,

91 (
uöt64_t
*)(uöt64_t)
lﬂdî_°ack
[4]

102 
ãmp1
 = "", 
ãmp2
 = (*)0xb8000;

103 *
ãmp1
;

104 
ãmp1
 +1, 
ãmp2
 += 2

105 Ë*
ãmp2
 = *
ãmp1
;

108 
	}
}

	@paging.c

1 
	~<sys/defs.h
>

2 
	~<°rög.h
>

3 
	~<sys/∑gög.h
>

4 
	~<sys/∑gög_hñ≥r.h
>

5 
	~<sys/k¥ötf.h
>

7 
uöt64_t
 *
	gpml4
;

8 
uöt64_t
 *
	gpd±
;

9 
uöt64_t
 *
	gpd
;

10 
uöt64_t
 *
	g±
;

12 
kînmem
;

13 
uöt64_t
 *
	g‰ì_m≠
;

14 
uöt64_t
 
	g¸3
;

15 
uöt64_t
 
	gphys‰ì_°¨t
, 
	gphys‰ì_íd
;

16 
uöt64_t
 
	gvút_addr
 = (uöt64_t)
KERNEL_BASE
;

17 
uöt64_t
 
	gu£r_addr
 = (uint64_t)0x88888fff80000000UL;

23 
	$öô_∑gög
(
uöt64_t
 
physba£
, uöt64_à
phys‰ì
, uöt64_à
ba£
, uöt64_à
Àngth
) {

24 
°¨t
 = 0;

25 
íd
 = 0;

26 
uöt64_t
 
addªss
 = 0;

28 
‰ì_m≠
 = (
uöt64_t
 *)
phys‰ì
;

29 
‰ì_m≠
 = 
	`mem£t
((*)‰ì_m≠, 0, (
uöt32_t
)256 * (
uöt64_t
));

31 
°¨t
 = 0;

32 
íd
 = (
ba£
+
Àngth
Ë/ 
PAGE_SIZE
;

33 
phys‰ì_°¨t
 = 
phys‰ì
;

34 
phys‰ì_°¨t
 +(
uöt64_t
)(256 * 64/8);

36 
phys‰ì_íd
 = 
ba£
 + 
Àngth
;

38 
°¨t
 < 
íd
) {

39 
addªss
 = 
°¨t
 * 
PAGE_SIZE
;

40 i‡(
addªss
 < 
phys‰ì_°¨t
) {

42 
°¨t
 ++;

46 
	`£t_bô
(
‰ì_m≠
, 
°¨t
);

47 
°¨t
++;

50 
	}
}

55 
	$gë_fú°∑ge
() {

56 
i
 = 0;

57 
j
 = 0;

59 
i
 = 0; i < 256; i++) {

60 
j
 = 0; j < 64; j++) {

61 i‡(
‰ì_m≠
[
i
] & (1uŒ << 
j
)) {

62  (
i
*64 + 
j
);

67 
	}
}

72 
uöt64_t
* 
	$Æloˇã_∑ge
() {

73 
uöt64_t
 
∑ge_addr
 = 0;

74 
uöt64_t
 
∑ge_ödex
 = 
	`gë_fú°∑ge
();

76 
	`un£t_bô
(
‰ì_m≠
, 
∑ge_ödex
);

77 
∑ge_addr
 = 
∑ge_ödex
 * 
PAGE_SIZE
;

78 
	`mem£t
((*)
∑ge_addr
, 0, (
uöt32_t
)
PAGE_SIZE
);

80  (
uöt64_t
 *)
∑ge_addr
;

81 
	}
}

87 
uöt64_t
* 
	$Æloˇã_vút_∑ge
() {

88 
uöt64_t
 
∑ge_addr
 = 0;

89 
uöt64_t
 
∑ge_ödex
 = 
	`gë_fú°∑ge
();

91 
	`un£t_bô
(
‰ì_m≠
, 
∑ge_ödex
);

92 
∑ge_addr
 = 
∑ge_ödex
 * 
PAGE_SIZE
;

94  (
uöt64_t
 *)
∑ge_addr
;

95 
	}
}

99 
	$pd±_Æloˇã
(
uöt64_t
 *
pml4
, uöt64_à
pml4_ödex
) {

100 
pd±
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

101 
uöt64_t
 
pd±_íåy
 = (uöt64_t)
pd±
;

102 
pd±_íåy
 |(
PT_PR
 | 
PT_WR
 | 
PT_U
 );

104 
pml4
[
pml4_ödex
] = 
pd±_íåy
;

106 
	}
}

108 
	$pd_Æloˇã
(
uöt64_t
* 
pd±
, uöt64_à
pd±_ödex
) {

109 
pd
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

110 
uöt64_t
 
pd_íåy
 = (uöt64_t)
pd
;

111 
pd_íåy
 |(
PT_PR
 | 
PT_WR
 | 
PT_U
);

113 
pd±
[
pd±_ödex
] = 
pd_íåy
;

115 
	}
}

117 
	$±_Æloˇã
(
uöt64_t
* 
pd
, uöt64_à
pd_ödex
) {

118 
±
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

119 
uöt64_t
 
±_íåy
 = (uöt64_t)
±
;

120 
±_íåy
 |(
PT_PR
 | 
PT_WR
 | 
PT_U
);

122 
pd
[
pd_ödex
] = 
±_íåy
;

124 
	}
}

129 
	$£tup_∑ge_èbÀs
(
uöt64_t
 
phys_ba£
, uöt64_à
phys_‰ì
) {

130 
uöt64_t
 
vAddªss
 = (uöt64_t)&
kînmem
;

131 
uöt64_t
 
pml4_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PML4_INDEX
);

132 
uöt64_t
 
pd±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PDPT_INDEX
);

133 
uöt64_t
 
pd_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PD_INDEX
);

134 
uöt64_t
 
±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PT_INDEX
);

135 
uöt64_t
 
addªss_±r
 = 
phys_ba£
;

137 
pml4
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

138 
addªss_±r
 = (
uöt64_t
)
pml4
;

139 
¸3
 = (
uöt64_t
)
addªss_±r
;

140 
	`k¥ötf
("¸3áddªs†now: %x\n",
¸3
);

142 
	`pd±_Æloˇã
(
pml4
, 
pml4_ödex
);

143 
	`pd_Æloˇã
(
pd±
, 
pd±_ödex
);

144 
	`±_Æloˇã
(
pd
, 
pd_ödex
);

147 ; 
phys_ba£
 < 
phys‰ì_°¨t
;Öhys_ba£ +0x1000, 
vAddªss
 += 0x1000) {

148 
±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PT_INDEX
);

149 
addªss_±r
 = 
phys_ba£
;

150 
addªss_±r
 |(
PT_PR
 | 
PT_WR
 );

151 
±
[
±_ödex
] = 
addªss_±r
;

154 
vAddªss
 = (
uöt64_t
)&
kînmem
;

155 
vAddªss
 &= 0xFFFFF000000;

156 
vAddªss
 |
VIDEO_PHYS_ADDR
;

157 
phys_ba£
 = 
VIDEO_PHYS_ADDR
;

161 
pd_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PD_INDEX
);

162 
±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PT_INDEX
);

163 
	`±_Æloˇã
(
pd
, 
pd_ödex
);

166 
addªss_±r
 = 
phys_ba£
;

167 
addªss_±r
 |(
PT_PR
 | 
PT_WR
 | 
PT_U
);

168 
±
[
±_ödex
] = 
addªss_±r
;

170 
vAddªss
 = 
KERNEL_ADDR
 | (
uöt64_t
)
pml4
;

171 
	`m≠_vút_to_phys_addr
((
uöt64_t
)
vAddªss
, (uöt64_t)
pml4
);

172 
vAddªss
 = 
KERNEL_ADDR
 | (
uöt64_t
)
pd±
;

173 
	`m≠_vút_to_phys_addr
((
uöt64_t
)
vAddªss
, (uöt64_t)
pd±
);

174 
vAddªss
 = 
KERNEL_ADDR
 | (
uöt64_t
)
pd
;

175 
	`m≠_vút_to_phys_addr
((
uöt64_t
)
vAddªss
, (uöt64_t)
pd
);

176 
vAddªss
 = 
KERNEL_ADDR
 | (
uöt64_t
)
±
;

177 
	`m≠_vút_to_phys_addr
((
uöt64_t
)
vAddªss
, (uöt64_t)
±
);

180 
	}
}

182 
	$m≠_vút_to_phys_addr
(
uöt64_t
 
vAddªss
, uöt64_à
phys
) {

183 
uöt64_t
 
pml4_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PML4_INDEX
);

184 
uöt64_t
 
pd±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PDPT_INDEX
);

185 
uöt64_t
 
pd_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PD_INDEX
);

186 
uöt64_t
 
±_ödex
 = 
	`gë_ödex
(
vAddªss
, 
PT_INDEX
);

188 
uöt64_t
 
pml4_addr
 = 
pml4
[
pml4_ödex
];

189 
uöt64_t
 
pd±_addr
;

190 
uöt64_t
 
pd_addr
;

191 
uöt64_t
 
±_addr
;

193 i‡(
pml4_addr
 & 
PT_PR
) {

194 
pd±
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pml4_addr
);

198 
pd±
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

199 
pml4
[
pml4_ödex
] = (
uöt64_t
)
pd±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

202 
pd±_addr
 = 
pd±
[
pd±_ödex
];

203 i‡(
pd±_addr
 & 
PT_PR
) {

204 
pd
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd±_addr
);

208 
pd
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

209 
pd±
[
pd±_ödex
] = (
uöt64_t
)
pd
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

211 
pd_addr
 = 
pd
[
pd_ödex
];

212 i‡(
pd_addr
 & 
PT_PR
) {

213 
±
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd_addr
);

217 
±
 = (
uöt64_t
 *)
	`Æloˇã_∑ge
();

218 
pd
[
pd_ödex
]=(
uöt64_t
)
±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

221 
±_addr
 = 
phys
;

222 
±_addr
 |(
PT_PR
 | 
PT_WR
 );

223 
±
[
±_ödex
] = 
±_addr
;

226 
	}
}

232 
	$m≠_phys_to_vút_addr
(
uöt64_t
 
vAddªss
, uöt64_à
phys
) {

233 
uöt64_t
 
pml4_ödex
 = (
vAddªss
 >> 
PML4_INDEX
) & 0x1FF;

234 
uöt64_t
 
pd±_ödex
 = (
vAddªss
 >> 
PDPT_INDEX
) & 0x1FF;;

235 
uöt64_t
 
pd_ödex
 = (
vAddªss
 >> 
PD_INDEX
) & 0x1FF;;

236 
uöt64_t
 
±_ödex
 = (
vAddªss
 >> 
PT_INDEX
) & 0x1FF;;

239 
uöt64_t
 
pml4_addr
 = 
pml4
[
pml4_ödex
];

240 
uöt64_t
 
pd±_addr
;

241 
uöt64_t
 
pd_addr
;

242 
uöt64_t
 
±_addr
;

244 i‡(
pml4_addr
 & 
PT_PR
) {

245 
pml4_addr
 = (
uöt64_t
 )
	`ªmove_Êag
(pml4_addr);

246 
pd±
 = (
uöt64_t
 *)
pml4_addr
;

247 
pd±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pdpt);

251 
pd±
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

252 
pml4
[
pml4_ödex
] = (
uöt64_t
)
pd±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

253 
pd±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pdpt);

256 
pd±_addr
 = 
pd±
[
pd±_ödex
];

257 i‡(
pd±_addr
 & 
PT_PR
) {

258 
pd
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd±_addr
);

259 
pd
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pd);

263 
pd
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

264 
pd±
[
pd±_ödex
] = (
uöt64_t
)
pd
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

265 
pd
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t )pd);

267 
pd_addr
 = 
pd
[
pd_ödex
];

268 i‡(
pd_addr
 & 
PT_PR
) {

269 
±
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd_addr
);

270 
±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pt);

274 
±
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

275 
pd
[
pd_ödex
]=(
uöt64_t
)
±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

276 
±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 | (uint64_t )pt);

279 
±_addr
 = 
phys
;

280 
±_addr
 |(
PT_PR
 | 
PT_WR
 | 
PT_U
);

281 
±
[
±_ödex
] = 
±_addr
;

284 
	}
}

286 
	$£t_idítôy_∑gög
() {

287 
uöt64_t
 
vAddr
 = (uöt64_t)
KERNEL_ADDR
;

288 
uöt64_t
 
pAddr
 = (uöt64_t)
PHYS_ADDR
;

290 ; 
pAddr
 < 
phys‰ì_íd
;ÖAdd∏+0x1000, 
vAddr
 += 0x1000) {

291 
	`m≠_vút_to_phys_addr
(
vAddr
, 
pAddr
);

293 
‰ì_m≠
 = (
uöt64_t
 *Ë(
KERNEL_ADDR
 | (uint64_t)free_map);

296 
	}
}

302 
uöt64_t
* 
	$kmÆloc
(
size
) {

303 
num_∑ge
 = 0;

304 
i
 = 0;

305 
uöt64_t
 
∑ge_addr
 = 0;

306 
uöt64_t
 
ªt_addr
;

308 i‡(
size
 % 
PAGE_SIZE
 == 0) {

309 
num_∑ge
 = 
size
 / 
PAGE_SIZE
;

312 
num_∑ge
 = (
size
 / 
PAGE_SIZE
) + 1;

314 
ªt_addr
 = 
vút_addr
 + 0x1000;

316 
i
 = 0; i < 
num_∑ge
; i++) {

317 
vút_addr
 += 0x1000;

318 
∑ge_addr
 = (
uöt64_t
 )
	`Æloˇã_vút_∑ge
();

319 
	`m≠_phys_to_vút_addr
((
uöt64_t
)
vút_addr
, (uöt64_t)
∑ge_addr
);

320 
	`mem£t
((*)
vút_addr
, 0, (
uöt32_t
)
PAGE_SIZE
);

323  (
uöt64_t
 *)
ªt_addr
;

324 
	}
}

326 
uöt64_t
* 
	$umÆloc
(
size
,
uöt64_t
* 
¸3_addr
) {

327 
num_∑ge
 = 0;

328 
i
 = 0;

329 
uöt64_t
 
∑ge_addr
 = 0;

330 
uöt64_t
 
ªt_addr
;

332 i‡(
size
 % 
PAGE_SIZE
 == 0) {

333 
num_∑ge
 = 
size
 / 
PAGE_SIZE
;

336 
num_∑ge
 = (
size
 / 
PAGE_SIZE
) + 1;

338 
ªt_addr
 = 
u£r_addr
 + 0x1000;

340 
i
 = 0; i < 
num_∑ge
; i++) {

341 
u£r_addr
 += 0x1000;

342 
∑ge_addr
 = (
uöt64_t
 )
	`Æloˇã_vút_∑ge
();

343 
	`m≠_phys_to_u£r_vút_addr
((
uöt64_t
)
u£r_addr
, (uöt64_t)
∑ge_addr
, (uöt64_à*)
¸3_addr
);

344 
	`mem£t
((*)
u£r_addr
, 0, (
uöt32_t
)
PAGE_SIZE
);

347  (
uöt64_t
 *)
ªt_addr
;

348 
	}
}

351 
uöt64_t
* 
	$¸óã_u£r_addªss_•a˚
() {

352 
uöt64_t
* 
pml4_addr
;

356 
uöt64_t
* 
pml4_vút_addr
;

357 
uöt64_t
* 
¸3_addr
;

359 
vút_addr
 += 0x1000;

360 
pml4_addr
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

361 
	`m≠_phys_to_vút_addr
((
uöt64_t
)
vút_addr
, (uöt64_t)
pml4_addr
);

362 
	`mem£t
((*)
vút_addr
, 0, (
uöt32_t
)
PAGE_SIZE
);

363 
__asm__
 vﬁ©ûe("mov %%¸3, %0" : "Ù" (
¸3_addr
));

368 
pml4_vút_addr
 = (
uöt64_t
 *)
vút_addr
;

369 
¸3_addr
 = (
uöt64_t
 *)–
KERNEL_ADDR
 | (uint64_t)cr3_addr);

370 
pml4_vút_addr
[511] = (
uöt64_t
)
¸3_addr
[511] | 
PT_U
;

379  
pml4_addr
;

380 
	}
}

383 
	$m≠_phys_to_u£r_vút_addr
(
uöt64_t
 
vAddªss
, uöt64_à
phys
, uöt64_à*
¸3_addr
) {

385 
	}
}

388 
	$m≠_phys_to_u£r_vút_addr
(
uöt64_t
 
vAddªss
, uöt64_à
phys
, uöt64_t* 
¸3_addr
) {

389 
uöt64_t
 
pml4_ödex
 = (
vAddªss
 >> 
PML4_INDEX
) & 0x1FF;

390 
uöt64_t
 
pd±_ödex
 = (
vAddªss
 >> 
PDPT_INDEX
) & 0x1FF;

391 
uöt64_t
 
pd_ödex
 = (
vAddªss
 >> 
PD_INDEX
) & 0x1FF;

392 
uöt64_t
 
±_ödex
 = (
vAddªss
 >> 
PT_INDEX
) & 0x1FF;

394 
¸3_addr
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)cr3_addr);

395 
uöt64_t
 
pml4_addr
 = 
¸3_addr
[
pml4_ödex
];

396 
uöt64_t
 
pd±_addr
;

397 
uöt64_t
 
pd_addr
;

399 
uöt64_t
* 
∑ge_addr
;

400 
uöt64_t
* 
vút_∑ge_addr
;

401 
uöt64_t
* 
physiˇl
;

403 i‡(
pml4_addr
 & 
PT_PR
) {

404 
pml4_addr
 = (
uöt64_t
 )
	`ªmove_Êag
(pml4_addr);

405 
pd±
 = (
uöt64_t
 *)
pml4_addr
;

406 
pd±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pdpt);

410 
pd±
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

411 
¸3_addr
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)cr3_addr);

412 
¸3_addr
[
pml4_ödex
] = (
uöt64_t
)
pd±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

413 
pd±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pdpt);

416 
pd±_addr
 = 
pd±
[
pd±_ödex
];

417 i‡(
pd±_addr
 & 
PT_PR
) {

418 
pd
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd±_addr
);

419 
pd
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pd);

423 
pd
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

424 
pd±
[
pd±_ödex
] = (
uöt64_t
)
pd
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

425 
pd
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t )pd);

427 
pd_addr
 = 
pd
[
pd_ödex
];

428 i‡(
pd_addr
 & 
PT_PR
) {

429 
±
 = (
uöt64_t
 *)
	`ªmove_Êag
(
pd_addr
);

430 
±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 |(uint64_t)pt);

434 
±
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

435 
pd
[
pd_ödex
]=(
uöt64_t
)
±
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

436 
±
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 | (uint64_t )pt);

439 
∑ge_addr
 = (
uöt64_t
 *)
	`Æloˇã_vút_∑ge
();

440 
vút_∑ge_addr
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 | (uöt64_à)
∑ge_addr
);

441 
physiˇl
 = (
uöt64_t
 *)((uöt64_t)
KERNEL_ADDR
 | (uöt64_à)
phys
);

443 
vút_∑ge_addr
 = (
uöt64_t
 *)
	`mem˝y
 ((*)vút_∑ge_addr, (*)
physiˇl
, 
PAGE_SIZE
);

447 
±
[
±_ödex
] = (
uöt64_t
)
∑ge_addr
 | (
PT_PR
 | 
PT_WR
 | 
PT_U
);

450 
	}
}

	@paging_helper.c

1 
	~<sys/defs.h
>

2 
	~<sys/∑gög.h
>

3 
	~<sys/∑gög_hñ≥r.h
>

4 
	~<°rög.h
>

6 
uöt64_t
 *
pml4
;

7 
uöt64_t
 *
pd±
;

8 
uöt64_t
 *
pd
;

9 
uöt64_t
 *
±
;

11 
kînmem
;

12 
uöt64_t
 *
‰ì_m≠
;

13 
uöt64_t
 
¸3
;

14 
uöt64_t
 
phys‰ì_°¨t
;

15 
uöt64_t
 
phys‰ì_íd
;

16 
uöt64_t
 
vút_addr
;

22 
	$£t_bô
(
uöt64_t
 *
m≠
, uöt64_à
vÆ
) {

23 
m≠
[
vÆ
/64] |= (1ull << (val%64));

24 
	}
}

29 
	$un£t_bô
(
uöt64_t
 *
m≠
, uöt64_à
vÆ
) {

30 
m≠
[
vÆ
/64] &= ~(1ull << (val%64));

31 
	}
}

33 
	$lﬂd_CR3
() {

34 
uöt64_t
 
pml4_addr

¸3
;

35 
__asm__
 vﬁ©ûe("movq %0, %%¸3":: "b"(
pml4_addr
));

36 
pml4
 = (
uöt64_t
 *)(
KERNEL_ADDR
 | (uint64_t)pml4);

37 
‰ì_m≠
 = (
uöt64_t
 *) (0xFFFFFFFF80000000UL | (uint64_t)free_map);

38 
	}
}

40 
	$£t_CR3
(
uöt64_t
 
pml4_addr
) {

41 
__asm__
 vﬁ©ûe("movq %0, %%¸3":: "b"(
pml4_addr
));

44 
	}
}

46 * 
	$mem£t
(*
±r
, 
x
, 
uöt32_t
 
n
) {

47 *
ãmp
 = (*)
±r
;

48 
n
 > 0) {

49 *
ãmp
 = 
x
;

50 
ãmp
++;

51 
n
 --;

53  
±r
;

54 
	}
}

56 * 
	$mem˝y
–*
§c
, *
de°
, 
uöt32_t
 
n
) {

57 *
ãmp1
 = (*)
§c
;

58 *
ãmp2
 = (*)
de°
;

59 
i
 = 0;

61 
i
 = 0; i < 
n
/2; i++) {

62 
ãmp2
[
i
] = 
ãmp1
[i];

64  
de°
;

66 
	}
}

68 
	$gë_ödex
(
uöt64_t
 
addªss
, 
off£t
) {

69 
addªss
 = (addªs†>> 
off£t
) & 0x1FF;

70  
addªss
;

71 
	}
}

73 
uöt64_t
 
	$gë_CR3_addªss
() {

74 
uöt64_t
 
¸3_addr
;

75 
__asm__
 vﬁ©ûe("mov %%¸3, %0" : "Ù" (
¸3_addr
));

76  
¸3_addr
;

77 
	}
}

80 
uöt64_t
 
	$ªmove_Êag
(
uöt64_t
 
addr
) {

81  (
uöt64_t
)(
addr
 & 0xFFFFFFFFFFFFF000UL);

82 
	}
}

	@pic.c

10 
	~<sys/pic.h
>

11 
	~<sys/defs.h
>

12 
	~<sys/piˇs£m.h
>

13 
	~<sys/idt.h
>

14 
	~<sys/k¥ötf.h
>

15 
	~<sys/piˇs£m.h
>

18 
i§0
();

19 
i§1
();

21 *
	gúq_routöes
[16]=

29 
	$úq_£t
(
ªq
, (*
h™dÀr
)(
ªgis
 *
r
)){

30 
úq_routöes
[
ªq
] = 
h™dÀr
;

31 
	}
}

35 
	$úq_ª£t
(
ªq
){

36 
úq_routöes
[
ªq
] = 0;

37 
	}
}

40 
	$PIC_ªm≠
(
off£t1
, 
off£t2
)

42 
a1
, 
a2
;

44 
a1
 = 
	`öb
(
PIC1_DATA
);

45 
a2
 = 
	`öb
(
PIC2_DATA
);

47 
	`outb
(
PIC1_COMMAND
, 
ICW1_INIT
+
ICW1_ICW4
);

48 
	`io_waô
();

49 
	`outb
(
PIC2_COMMAND
, 
ICW1_INIT
+
ICW1_ICW4
);

50 
	`io_waô
();

51 
	`outb
(
PIC1_DATA
, 
off£t1
);

52 
	`io_waô
();

53 
	`outb
(
PIC2_DATA
, 
off£t2
);

54 
	`io_waô
();

55 
	`outb
(
PIC1_DATA
, 4);

56 
	`io_waô
();

57 
	`outb
(
PIC2_DATA
, 2);

58 
	`io_waô
();

60 
	`outb
(
PIC1_DATA
, 
ICW4_8086
);

61 
	`io_waô
();

62 
	`outb
(
PIC2_DATA
, 
ICW4_8086
);

63 
	`io_waô
();

65 
	`outb
(
PIC1_DATA
, 
a1
);

66 
	`outb
(
PIC2_DATA
, 
a2
);

67 
	}
}

69 
	$PIC_£ndEOI
(
uöt8_t
 
úq
)

71 if(
úq
 >= 8)

72 
	`outb
(
PIC2_COMMAND
,
PIC_EOI
);

73 
	`outb
(
PIC1_COMMAND
,
PIC_EOI
);

74 
	}
}

76 
	$öô_picúr
(){

77 
	`PIC_ªm≠
(0x20, 0x28);

80 
	`£t_idt_g©e
(
INTR_0
 ,(
uöt64_t
)
i§0
, 
IDT_SEL
 , 
INTERRUPT_GATE
);

82 
	`£t_idt_g©e
(
INTR_1
 ,(
uöt64_t
)
i§1
, 
IDT_SEL
 , 
INTERRUPT_GATE
);

83 
	}
}

85 
	$öå_h™dÀr
(
ªgis
* 
ªgs
){

87 (*
h™dÀr
Ë(
ªgis
 *
ªgs
)
NULL
;

88 
uöt64_t
 
sys
 = 0;

89 
__asm__
 volatile(

91 : "˜"(
sys
)

95 
h™dÀr
 = 
úq_routöes
[
sys
 - 32];

96 if(
h™dÀr
)

98 
	`h™dÀr
(
ªgs
);

101 
	`PIC_£ndEOI
(
sys
-32);

102 
	}
}

	@picassem.c

7 
	~<sys/piˇs£m.h
>

8 
	~<sys/defs.h
>

10 
	$outb
(
uöt16_t
 
p‹t
, 
uöt8_t
 
vÆ
)

12 
__asm__
 vﬁ©ûê–"outb %0, %1" : : "a"(
vÆ
), "Nd"(
p‹t
) );

13 
	}
}

15 
uöt8_t
 
	$öb
(
uöt16_t
 
p‹t
)

17 
uöt8_t
 
ªt
;

18 
__asm__
 volatile ( "inb %1, %0"

19 : "˜"(
ªt
)

20 : "Nd"(
p‹t
) );

21  
ªt
;

22 
	}
}

24 
	$io_waô
()

26 
__asm__
 volatile ( "outb %%al, $0x80" : : "a"(0) );

27 
	}
}

	@process.c

1 
	~<sys/defs.h
>

2 
	~<sys/gdt.h
>

3 
	~<sys/k¥ötf.h
>

4 
	~<sys/èrfs.h
>

5 
	~<sys/ahci.h
>

6 
	~<sys/idt.h
>

7 
	~<sys/pic.h
>

8 
	~<sys/timî.h
>

9 
	~<sys/kb.h
>

10 
	~<sys/∑gög.h
>

11 
	~<sys/∑gög_hñ≥r.h
>

12 
	~<sys/¥o˚ss.h
>

14 
uöt64_t
 *
pml4
;

15 
uöt64_t
 *
	gﬁd_r•
;

16 
uöt64_t
 *
	gr•_addr
;

17 
uöt64_t
 
	g¥o˚ssID
 = 0;

18 
uöt64_t
 *
	gu£r_vútuÆ_addªss
 = (uint64_t*)0x88888fff80000000UL;

19 
pcb_t
 *
	gfú°_¥o˚ss
;

20 
pcb_t
 *
	gcuº_¥o˚ss
;

21 
pcb_t
 *
	g√xt_¥o˚ss
;

27 
	$gë_√xt_¥o˚ssID
() {

28 
id
 = 1;

29 
i
 = 0;

31 
i
 = 0; i < 
MAX_PROCESS_COUNT
; i++) {

32 i‡(((
¥o˚ssID
 >> 
i
Ë& 
id
) == 0x0){

33 
¥o˚ssID
 |(
id
 << 
i
);

34  
i
+1;

38 
	}
}

44 
	$¸óã_kî√l_thªad
() {

45 
pcb_t
 *
k_pcb
 = (pcb_à*)
	`kmÆloc
(()6000);

47 
k_pcb
->
pid
 = 
	`gë_√xt_¥o˚ssID
();

48 
k_pcb
->
µid
 = 0;

49 
k_pcb
->
¸3
 = (
uöt64_t
)
	`gë_CR3_addªss
();

50 
k_pcb
->
°©e
 = 
TASK_RUNNING
;

51 
k_pcb
->
√xt_¥oc
 = 
√xt_¥o˚ss
;

52 
k_pcb
->
mm
 = 
NULL
;

55 
fú°_¥o˚ss
 = (
pcb_t
 *)
k_pcb
;

56 
cuº_¥o˚ss
 = (
pcb_t
 *)
k_pcb
;

58 
k_pcb
->
r•
 = k_pcb->
öô_kî√l
 = ((
uöt64_t
)k_pcb + 
PAGE_SIZE
);

59 
k_pcb
->
r•
 -= 8;

60 *(
uöt64_t
 *)(
k_pcb
->
r•
Ë(uöt64_t)&
öôül_ªt_fun˘i⁄
;

62 
	`¸óã_√w_thªad
();

68 
	`scheduÀr
();

70 
	`öôül_ªt_fun˘i⁄
();

73 
	}
}

79 
	$¸óã_√w_thªad
() {

80 
pcb_t
 *
chûd_pcb
 = (pcb_à*)
	`kmÆloc
(()6000);

81 
√xt_¥o˚ss
 = (
pcb_t
 *)
chûd_pcb
;

83 
chûd_pcb
->
pid
 = 
	`gë_√xt_¥o˚ssID
();

84 
chûd_pcb
->
µid
 = 0;

86 
chûd_pcb
->
¸3
 = (
uöt64_t
)
	`gë_CR3_addªss
();

87 
chûd_pcb
->
°©e
 = 
TASK_READY
;

88 
chûd_pcb
->
√xt_¥oc
 = 
cuº_¥o˚ss
;

89 
chûd_pcb
->
mm
 = 
NULL
;

90 
chûd_pcb
->
rù
 = (
uöt64_t
)&
ã°_fun˘i⁄
;

92 
chûd_pcb
->
r•
 = chûd_pcb->
öô_kî√l
 = ((
uöt64_t
)chûd_pcb + 
PAGE_SIZE
);

93 
chûd_pcb
->
r•
 -= 8;

94 *(
uöt64_t
 *)(
chûd_pcb
->
r•
Ë(uöt64_t)&
ã°_fun˘i⁄
;

96 
chûd_pcb
->
ªgs
.
øx
 = chûd_pcb->ªgs.
rbx
 = chûd_pcb->ªgs.
rdi
 = chûd_pcb->ªgs.
rsi
 = chûd_pcb->ªgs.
rbp
 = 0;

99 
	}
}

105 
pcb_t
* 
	$¸óã_u£r_¥o˚ss
() {

106 
pcb_t
 *
u£r_pcb
 = (pcb_à*)
	`kmÆloc
(()6000);

107 
uöt64_t
 
off£t
 = 0;

108 
mm_°ru˘_t
 *
vma
;

110 
u£r_pcb
->
pid
 = 
	`gë_√xt_¥o˚ssID
();

111 
u£r_pcb
->
µid
 = 0;

112 
u£r_pcb
->
¸3
 = (
uöt64_t
)
	`¸óã_u£r_addªss_•a˚
();

113 
u£r_pcb
->
rù
 = (
uöt64_t
)&
ã°_u£r_thªad
;

114 
off£t
 = 
u£r_pcb
->
rù
 & 0xfff;

116 
u£r_pcb
->
°©e
 = 
TASK_READY
;

117 
u£r_pcb
->
√xt_¥oc
 = 
fú°_¥o˚ss
;

118 
vma
 = (
mm_°ru˘_t
 *)
	`kmÆloc
(1000);

119 
u£r_pcb
->
mm
 = 
vma
;

129 
u£r_pcb
->
r•
 = u£r_pcb->
öô_kî√l
 = ((
uöt64_t
)u£r_pcb + 
PAGE_SIZE
);

131 
	`£t_u£r_•a˚
(
u£r_pcb
, 
off£t
);

136  
u£r_pcb
;

137 
	}
}

143 
	$öôül_ªt_fun˘i⁄
() {

144 
__asm__
 volatile("sti");

146 
	`öô_idt
();

148 
	`öô_picúr
();

150 
	`öô_timî
(1000);

151 
	`kb_öô
();

152 
i
 = 0;

153 
i
 < 4) {

154 
	`k¥ötf
("Iám in kernelÅhreadágain\n");

155 
	`swôchTask
(
fú°_¥o˚ss
, 
√xt_¥o˚ss
);

156 
i
 ++;

163 
	}
}

169 
	$ã°_fun˘i⁄
() {

171 
i
 = 0;

172 
i
 < 5) {

173 
	`k¥ötf
("Iám inÅhread 1áfter context switch\n");

174 
	`swôchTask
(
√xt_¥o˚ss
, 
fú°_¥o˚ss
);

175 
i
++;

178 
	}
}

181 
	$ã°_u£r_thªad
() {

183 
a
 = 10;

184 
a
 =á * 12;

186 
	}
}

189 
	$scheduÀr
() {

193 
	`swôchTask
(
cuº_¥o˚ss
, 
√xt_¥o˚ss
);

194 
	}
}

200 
	$swôchTask
(
pcb_t
 *
cuºít
,Öcb_à*
√xt
) {

218 
__asm__
 vﬁ©ûe("movq %%rdi, %0;" : "Ù"(
cuºít
->
ªgs
.
rdi
));

219 
__asm__
 vﬁ©ûe("movq %%rsi, %0;" : "Ù"(
cuºít
->
ªgs
.
rsi
));

220 
__asm__
 vﬁ©ûe("movq %%øx, %0;" : "Ù"(
cuºít
->
ªgs
.
øx
));

221 
__asm__
 vﬁ©ûe("movq %%rbx, %0;" : "Ù"(
cuºít
->
ªgs
.
rbx
));

222 
__asm__
 vﬁ©ûe("movq %%rbp, %0;" : "Ù"(
cuºít
->
ªgs
.
rbp
));

225 
__asm__
 vﬁ©ûê("movq %%r•, %0;":"Ù"(
cuºít
->
r•
));

226 
__asm__
 vﬁ©ûê("movq %0, %%r•;"::"r"(
√xt
->
r•
));

228 
__asm__
 vﬁ©ûê("movq %0, %%rdi;" :: "r"(
√xt
->
ªgs
.
rdi
));

229 
__asm__
 vﬁ©ûê("movq %0, %%øx;" :: "r"(
√xt
->
ªgs
.
øx
));

230 
__asm__
 vﬁ©ûê("movq %0, %%rbx;" :: "r"(
√xt
->
ªgs
.
rbx
));

231 
__asm__
 vﬁ©ûê("movq %0, %%rbp;" :: "r"(
√xt
->
ªgs
.
rbp
));

232 
__asm__
 vﬁ©ûê("movq %0, %%rsi;" :: "r"(
√xt
->
ªgs
.
rsi
));

235 
	}
}

240 
	$swôchBack
(
pcb_t
 *
cuºít
,Öcb_à*
√xt
) {

242 
__asm__
 vﬁ©ûê("movq %%r•, %0;" : "Ù"((
cuºít
->
öô_kî√l
)));

243 
__asm__
 vﬁ©ûê("movq %0, %%r•;" :: "r"((
√xt
->
öô_kî√l
)));

245 
√xt
->
öô_kî√l
 = (
uöt64_t
)next->init_kernel;

246 
	`£t_tss_r•
((*)
√xt
->
öô_kî√l
);

248 
__asm__
 volatile ("ret");

250 
	}
}

255 
	$swôch_to_rög3
(
pcb_t
 *
¥oc
) {

256 
¥oc
->
°©e
 = 
TASK_RUNNING
;

258 
	`£t_tss_r•
((*Ë
¥oc
->
öô_kî√l
);

260 
__asm__
 volatile ("cli" ::);

261 
__asm__
 vﬁ©ûê("movq %0, %%¸3;" :: "r"(
¥oc
->
¸3
));

262 
__asm__
 volatile ("mov $0x23, %%ax" ::);

263 
__asm__
 volatile ("mov %%ax, %%ds;" ::);

264 
__asm__
 volatile ("mov %%ax, %%es;" ::);

265 
__asm__
 volatile ("mov %%ax, %%fs;" ::);

266 
__asm__
 volatile ("mov %%ax, %%gs;" ::);

267 
__asm__
 vﬁ©ûê("movq %0, %%øx;"::"r"(
¥oc
->
r•
));

268 
__asm__
 volatile ("pushq $0x23" ::);

270 
__asm__
 volatile ("pushq %%rax" ::);

271 
__asm__
 volatile ("pushfq" ::);

275 
__asm__
 volatile ("pushq $0x2B" ::);

276 
__asm__
 vﬁ©ûê("pushq %0;" :: "r"(
¥oc
->
rù
));

277 
__asm__
 volatile ("movq $0x0, %%rdi" ::);

278 
__asm__
 volatile ("movq $0x0, %%rsi" ::);

279 
__asm__
 volatile ("iretq" ::);

283 
	}
}

285 
	$£t_u£r_•a˚
(
pcb_t
 *
u£r_¥o˚ss
, 
uöt64_t
 
off£t
) {

286 
uöt64_t
* 
u£r_∑ge
 = (uöt64_à*)
u£r_¥o˚ss
->
rù
;

287 
uöt64_t
* 
u£r_vútuÆ_addr
;

289 
u£r_vútuÆ_addªss
 += 0x1000UL;

290 
u£r_∑ge
 = (
uöt64_t
 *)(0x000000000FFFF000UL & (uint64_t)user_page);

291 
u£r_vútuÆ_addr
 = (
uöt64_t
 *)((uöt64_t)
u£r_vútuÆ_addªss
 | (uöt64_t)
u£r_∑ge
);

294 
	`m≠_phys_to_u£r_vút_addr
((
uöt64_t
)
u£r_vútuÆ_addr
, (uöt64_t)
u£r_∑ge
, (uöt64_à*)
u£r_¥o˚ss
->
¸3
);

295 
u£r_¥o˚ss
->
rù
 = (
uöt64_t
)
u£r_vútuÆ_addr
 | 
off£t
;

297 
	}
}

	@string.c

5 
	$°æí
(*
°r
) {

6 
i
 = 0;

7 *
°r
 != '\0') {

8 
i
++;

9 
°r
++;

11  
i
;

12 
	}
}

17 *
	$°r˝y
(*
§c
, *
d°
) {

18 *
ãmp
 = (*)
d°
;

19 *
§c
 != '\0') {

20 *
ãmp
++ = *
§c
++;

22 *
ãmp
 = '\0';

23  
d°
;

24 
	}
}

29 
	$°rcmp
(*
°r1
, *
°r2
) {

31 *
°r1
 !'\0' && *
°r2
 != '\0') {

32 i‡(*
°r1
 !*
°r2
) {

35 
°r1
++;

36 
°r2
++;

38 i‡(*
°r1
 !'\0' || *
°r2
 != '\0') {

42 
	}
}

44 
	$©oi
(*
°r
) {

45 
vÆ
 = 0;

46 *
°r
 != '\0') {

47 
vÆ
 = (vÆ * 10Ë+ (*
°r
 - '0');

48 
°r
++;

50  
vÆ
;

51 
	}
}

	@tarfs.c

1 
	~<sys/defs.h
>

2 
	~<sys/gdt.h
>

3 
	~<sys/k¥ötf.h
>

4 
	~<sys/èrfs.h
>

5 
	~<sys/ahci.h
>

6 
	~<sys/idt.h
>

7 
	~<sys/pic.h
>

8 
	~<sys/timî.h
>

9 
	~<sys/kb.h
>

10 
	~<sys/∑gög.h
>

11 
	~<sys/∑gög_hñ≥r.h
>

12 
	~<sys/¥o˚ss.h
>

13 
	~<sys/utûs.h
>

14 
	~<sys/°rög.h
>

16 
èrfûe_t
 
	gglobÆ_èrfs
[100];

17 
	gfûe_cou¡
 = 0;

18 
	gãmp_fûíame
[100];

20 
uöt64_t
 
	$is_fûe_exi°
(*
fûíame
) {

21 
èrfs_t
 *
èrfs_°¨t
 = (èrfs_à*)&
_bö¨y_èrfs_°¨t
;

22 
off£t
 = 0;

23 
size
 = 0;

25 
	`°æí
(
èrfs_°¨t
->
«me
) != 0) {

26 
	`k¥ötf
("fûe: %†",
èrfs_°¨t
->
«me
);

27 
size
 = 
	`©oi
(
èrfs_°¨t
->size);

28 
size
 = 
	`o˘todec
(size);

29 i‡(
	`°rcmp
(
èrfs_°¨t
->
«me
, 
fûíame
) == 0) {

30  
off£t
 + 
TARFS_HEADER
;

32 i‡–
size
 == 0) {

33 
off£t
 +
TARFS_HEADER
;

36 i‡(
size
 % 
TARFS_HEADER
 == 0) {

37 
off£t
 +
size
 + 
TARFS_HEADER
;

40 
off£t
 +((
size
 / 
TARFS_HEADER
) + 1) * TARFS_HEADER + TARFS_HEADER;

43 
èrfs_°¨t
 = (
èrfs_t
 *)(&
_bö¨y_èrfs_°¨t
 + 
off£t
);

46 
	}
}

52 
	$gë_∑ª¡_öode
(* 
fûe
) {

54 
Àn
 = 
	`°æí
(
fûe
);

56 
Àn
 --;

57 
	`°r˝y
(
fûe
, 
ãmp_fûíame
);

58 
fûe
[
Àn
] != '\\') {

59 
Àn
 --;

60 i‡(
Àn
 == 0) {

64 
ãmp_fûíame
[++
Àn
] = '\0';

66 
Àn
 = 0;

67 
Àn
 < 
fûe_cou¡
) {

68 i‡(
	`°rcmp
(
ãmp_fûíame
, 
globÆ_èrfs
[
Àn
].
«me
) == 0) {

69  
Àn
;

71 
Àn
 ++;

74 
	}
}

80 
	$öô_èrfs
() {

81 
ödex
 = 0;

82 
off£t
 = 0;

83 
size
 = 0;

84 
öt_vÆ
 = 0;

85 
èrfs_t
 *
èrfs_ôî
 = (èrfs_à*)&
_bö¨y_èrfs_°¨t
;

87 
	`°æí
(
èrfs_ôî
->
«me
) != 0) {

88 
size
 = 
	`©oi
(
èrfs_ôî
->size);

89 
size
 = 
	`o˘todec
(size);

91 
	`°r˝y
(
èrfs_ôî
->
«me
, 
globÆ_èrfs
[
ödex
].name);

93 
globÆ_èrfs
[
ödex
].
size
 = size;

94 
öt_vÆ
 = 
	`©oi
(
èrfs_ôî
->
ty≥Êag
);

97 
öt_vÆ
 = 
	`gë_∑ª¡_öode
(
globÆ_èrfs
[
ödex
].
«me
);

98 i‡(
öt_vÆ
 == -1) {

99 
globÆ_èrfs
[
ödex
].
p_öode
 = 0;

102 
globÆ_èrfs
[
ödex
].
p_öode
 = 
öt_vÆ
;

105 
globÆ_èrfs
[
ödex
].
ty≥
 = 
öt_vÆ
;

106 
globÆ_èrfs
[
ödex
].
addr
 = (
uöt64_t
)&
_bö¨y_èrfs_°¨t
 + 
off£t
 + 
TARFS_HEADER
;

107 
globÆ_èrfs
[
ödex
].
öode
 = ++
fûe_cou¡
;

109 i‡–
size
 == 0) {

110 
off£t
 +
TARFS_HEADER
;

113 i‡(
size
 % 
TARFS_HEADER
 == 0) {

114 
off£t
 +
size
 + 
TARFS_HEADER
;

117 
off£t
 +((
size
 / 
TARFS_HEADER
) + 1) * TARFS_HEADER + TARFS_HEADER;

120 
ödex
 ++;

121 
èrfs_ôî
 = (
èrfs_t
 *)(&
_bö¨y_èrfs_°¨t
 + 
off£t
);

124 
	}
}

129 
	$›í
(*
fûíame
, 
≥rmissi⁄
) {

130 
ôî©‹
 = 0;

132 
ôî©‹
 < 
fûe_cou¡
) {

133 i‡(
	`°rcmp
(
fûíame
, 
globÆ_èrfs
[
ôî©‹
].
«me
) == 0) {

134  
globÆ_èrfs
[
ôî©‹
].
öode
;

136 
ôî©‹
 ++;

139 
	}
}

144 
	$ªad
(
fd
, *
buf
, 
size
) {

145 
Àngth
 = 0;

146 
ôî©‹
 = 0;

147 *
c⁄ã¡
;

149 
ôî©‹
 < 
fûe_cou¡
) {

150 i‡(
globÆ_èrfs
[
ôî©‹
].
öode
 =
fd
) {

151 
fd
 = 
ôî©‹
;

154 
ôî©‹
++;

156 
Àngth
 = 
globÆ_èrfs
[
fd
].
size
;

157 
c⁄ã¡
 = (*)
globÆ_èrfs
[
fd
].
addr
;

159 
Àngth
 = (Àngth > 
size
)?size:length;

160 
	`mem˝y
((*)
c⁄ã¡
, (*)
buf
, 
Àngth
);

162  
Àngth
;

163 
	}
}

169 
	$˛o£
(
fd
) {

171 
	}
}

176 
	$›ídú
(*
fûíame
) {

177 
ôî©‹
 = 0;

179 
ôî©‹
 < 
fûe_cou¡
) {

180 i‡((
globÆ_èrfs
[
ôî©‹
].
ty≥
 =
DIRECTORY
Ë&& (
	`°rcmp
(
fûíame
, globÆ_èrfs[ôî©‹].
«me
) == 0)) {

181  
globÆ_èrfs
[
ôî©‹
].
öode
;

183 
ôî©‹
 ++;

187 
	}
}

192 
	$ªad_dú
(
fd
, *
buf
, 
size
) {

193 
Àngth
 = 0;

194 
ôî©‹
 = 0;

195 *
c⁄ã¡
;

197 
ôî©‹
 < 
fûe_cou¡
) {

198 i‡(
globÆ_èrfs
[
ôî©‹
].
öode
 =
fd
) {

199 
fd
 = 
ôî©‹
;

202 
ôî©‹
++;

204 
Àngth
 = 
globÆ_èrfs
[
fd
].
size
;

205 
c⁄ã¡
 = (*)
globÆ_èrfs
[
fd
].
addr
;

207 
Àngth
 = (Àngth > 
size
)?size:length;

208 
	`mem˝y
((*)
c⁄ã¡
, (*)
buf
, 
Àngth
);

210  
Àngth
;

211 
	}
}

213 
	$˛o£_dú
(
fd
) {

215 
	}
}

	@timer.c

1 
	~<sys/piˇs£m.h
>

2 
	~<sys/k¥ötf.h
>

3 
	~<sys/pic.h
>

4 
	~<sys/idt.h
>

7 
	gtimî_tic
 = 0;

9 
	$timî_cou¡
(
hz
){

10 
div
 = 1193180/
hz
;

11 
	`outb
(0x43,0x36);

12 
	`outb
(0x40, 
div
 & 0xFF);

13 
	`outb
(0x40, 
div
 >> 8);

14 
	}
}

16 
	$timî_h™dÀr
(
ªgis
 *
r
){

18 
timî_tic
++;

19 
	`outb
(0x20,0x20);

20 
	`outb
(0xa0,0x20);

22 if(
timî_tic
 % 1000 == 0){

24 
	`k¥ötf_timî
(
timî_tic
/1000);

26 
	}
}

29 
	$öô_timî
(
hz
){

30 
	`timî_cou¡
(
hz
);

31 
	`úq_£t
(0, 
timî_h™dÀr
);

32 
	}
}

	@utils.c

5 
	$pow
(
ba£
, 
exp
) {

6 
vÆ
 = 0;

8 i‡(
exp
 == 0) {

11 
vÆ
 = 
ba£
 * 
	`pow
(ba£, 
exp
 -1);

13  
vÆ
;

14 
	}
}

19 
	$o˘todec
(
o˘Æ_vÆ
) {

20 
öt_vÆ
 = 0;

21 
pow_eight
 = 0;

23 
o˘Æ_vÆ
 > 0) {

24 
öt_vÆ
 +(
o˘Æ_vÆ
 % 10Ë* 
	`pow
(8, 
pow_eight
);

25 
o˘Æ_vÆ
 /= 10;

26 
pow_eight
 ++;

28  
öt_vÆ
;

29 
	}
}

	@vma.c

1 
	~<sys/defs.h
>

2 
	~<sys/k¥ötf.h
>

3 
	~<sys/èrfs.h
>

4 
	~<sys/idt.h
>

5 
	~<sys/pic.h
>

6 
	~<sys/timî.h
>

7 
	~<sys/∑gög.h
>

8 
	~<sys/∑gög_hñ≥r.h
>

9 
	~<sys/¥o˚ss.h
>

10 
	~<sys/utûs.h
>

11 
	~<sys/°rög.h
>

13 
èrfûe_t
 
globÆ_èrfs
[100];

18 
vma_t
* 
	$¸óã_vma
(
uöt64_t
 
vm_°¨t
, uöt64_à
vm_íd
, 
p_Êags
) {

19 
vma_t
 *
vma
;

21 
vma
 = (
vma_t
 *)
	`kmÆloc
((vma_t *));

22 
vma
->
vm_°¨t
 = vm_start;

23 
vma
->
vm_íd
 = vm_end;

24 
vma
->
Êags
 = 
p_Êags
 | 
PFLAG_US
;

25  
vma
;

26 
	}
}

28 
	$add_mm°ru˘
(
mm_°ru˘_t
 *
mm
, 
vma_t
 *
vma
) {

29 
vma_t
 *
cuº
;

31 i‡(
vma
->
vm_°¨t
 >vma->
vm_íd
) {

35 
cuº
 = 
mm
->
vma
;

36 i‡(!
mm
->
vma
 || vma->
vm_íd
 <
cuº
->vm_end) {

37 
mm
->
vma
 = vma;

38 
vma
->
vm_√xt
 = 
mm
->vma;

39 
vma
->
vm_mm
 = 
mm
;

40 
mm
->
vma_cou¡
 ++;

43 ; 
cuº
 !
NULL
; cuº = cuº->
vm_√xt
) {

44 i‡(
cuº
->
vm_√xt
 !
NULL
 || cuº->vm_√xt->
vm_°¨t
 >
vma
->
vm_íd
) {

45 
vma
->
vm_√xt
 = 
cuº
->vm_next;

46 
cuº
->
vm_√xt
 = 
vma
;

47 
vma
->
vm_mm
 = 
mm
;

48 
mm
->
vma_cou¡
 ++;

53 
	}
}

55 
	$mm≠_Æloc
(
mm_°ru˘_t
 *
mm
, 
Â
, 
uöt64_t
 
fûe_°¨t
, uöt64_à
size
, uöt64_à
vm_°¨t
, uöt64_à
vm_íd
, 
p_Êags
) {

56 
vma_t
 *
vm_Æloc
;

58 
vma_Æloc
 = 
	`¸óã_vma
(
vm_°¨t
, 
vm_íd
, 
p_Êags
);

59 
vma_Æloc
->
fûe_±
 = 
Â
;

60 
vma_Æloc
->
fûe_°¨t
 = file_start;

61 
vma_Æloc
->
fûe_size
 = 
size
;

63 
	`add_mm°ru˘
(
mm
, 
vma_Æloc
);

65 
	}
}

	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


171 *
	$°rdup
 (c⁄° *
__s
)

172 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

178 #i‡
deföed
 
__USE_XOPEN2K8


179 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

180 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

183 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


185 
	#°rdu∑
(
s
) \

186 (
__exãnsi⁄__
 \

188 c⁄° *
__ﬁd
 = (
s
); \

189 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

190 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

191 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

192 
	}
}))

	)

195 
	#°∫du∑
(
s
, 
n
) \

196 (
__exãnsi⁄__
 \

198 c⁄° *
__ﬁd
 = (
s
); \

199 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

200 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

201 
__√w
[
__Àn
] = '\0'; \

202 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

203 }))

	)

206 
	g__BEGIN_NAMESPACE_STD


208 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


211 *
°rchr
 (*
__s
, 
__c
)

212 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

213 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

214 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

216 #ifde‡
__OPTIMIZE__


217 
__exã∫_Æways_ölöe
 *

218 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


220  
__buûtö_°rchr
 (
__s
, 
__c
);

223 
__exã∫_Æways_ölöe
 const *

224 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


226  
__buûtö_°rchr
 (
__s
, 
__c
);

231 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

232 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

235 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


238 *
	`°ºchr
 (*
__s
, 
__c
)

239 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

240 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

243 #ifde‡
__OPTIMIZE__


244 
__exã∫_Æways_ölöe
 *

245 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


247  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

250 
__exã∫_Æways_ölöe
 const *

251 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


253  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

256 
	}
}

258 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

259 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

261 
__END_NAMESPACE_STD


263 #ifde‡
__USE_GNU


266 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


267 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

268 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

269 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

272 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

273 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 
__BEGIN_NAMESPACE_STD


280 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

281 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

284 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

285 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

287 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


290 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

291 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

292 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

293 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

295 #ifde‡
__OPTIMIZE__


296 
__exã∫_Æways_ölöe
 *

297 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


299  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

302 
__exã∫_Æways_ölöe
 const *

303 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


305  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

308 
	}
}

310 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

311 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

314 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


317 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

318 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

319 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

320 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

322 #ifde‡
__OPTIMIZE__


323 
__exã∫_Æways_ölöe
 *

324 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


326  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

329 
__exã∫_Æways_ölöe
 const *

330 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


332  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

335 
	}
}

337 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

338 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

343 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

344 
__THROW
 
	`__n⁄nuŒ
 ((2));

345 
__END_NAMESPACE_STD


349 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

350 c⁄° *
__ª°ri˘
 
__dñim
,

351 **
__ª°ri˘
 
__ßve_±r
)

352 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

353 #ifde‡
__USE_POSIX


354 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

355 **
__ª°ri˘
 
__ßve_±r
)

356 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

359 #ifde‡
__USE_GNU


361 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


362 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

363 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

364 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

365 c⁄° *
__√edÀ
)

366 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

368 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

369 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 #ifde‡
__USE_GNU


377 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

378 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

379 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

383 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

384 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

385 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

386 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

387 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

388 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

392 
__BEGIN_NAMESPACE_STD


394 
size_t
 
	$°æí
 (c⁄° *
__s
)

395 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

396 
__END_NAMESPACE_STD


398 #ifdef 
__USE_XOPEN2K8


401 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

402 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

406 
__BEGIN_NAMESPACE_STD


408 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

409 
__END_NAMESPACE_STD


410 #ifde‡
__USE_XOPEN2K


418 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


421 #ifde‡
__REDIRECT_NTH


422 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

423 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

424 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

426 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

427 
__THROW
 
	`__n⁄nuŒ
 ((2));

428 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

433 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

434 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

438 #ifde‡
__USE_XOPEN2K8


440 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

446 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

448 #ifde‡
__USE_MISC


450 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

451 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

454 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

457 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

458 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

461 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


464 *
	`ödex
 (*
__s
, 
__c
)

465 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

466 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

467 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

469 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


470 
__exã∫_Æways_ölöe
 *

471 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


473  
	`__buûtö_ödex
 (
__s
, 
__c
);

476 
__exã∫_Æways_ölöe
 const *

477 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


479  
	`__buûtö_ödex
 (
__s
, 
__c
);

482 
	}
}

484 *
	$ödex
 (c⁄° *
__s
, 
__c
)

485 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

489 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


492 *
	`rödex
 (*
__s
, 
__c
)

493 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

495 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

497 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


498 
__exã∫_Æways_ölöe
 *

499 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


501  
	`__buûtö_rödex
 (
__s
, 
__c
);

504 
__exã∫_Æways_ölöe
 const *

505 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


507  
	`__buûtö_rödex
 (
__s
, 
__c
);

510 
	}
}

512 *
	$rödex
 (c⁄° *
__s
, 
__c
)

513 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

518 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

522 #ifdef 
__USE_GNU


523 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

524 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

525 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

530 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

533 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

534 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

537 #ifdef 
__USE_GNU


540 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

541 
__loˇÀ_t
 
__loc
)

542 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

544 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

545 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

546 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

549 #ifdef 
__USE_MISC


552 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

553 c⁄° *
__ª°ri˘
 
__dñim
)

554 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

557 #ifdef 
__USE_XOPEN2K8


559 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

562 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

563 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

564 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

565 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

570 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

571 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 #ifdef 
__USE_GNU


579 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

580 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

583 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

586 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

588 #i‚de‡
ba£«me


593 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


594 "C++" *
	$ba£«me
 (*
__fûíame
)

595 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

596 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

597 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

605 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

606 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

607 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


627 
	~<bôs/°rög.h
>

630 
	~<bôs/°rög2.h
>

633 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


635 
	~<bôs/°rög3.h
>

639 #i‡
deföed
 
__USE_GNU
 && deföed 
__OPTIMIZE__
 \

640 && 
deföed
 
__exã∫_Æways_ölöe
 && 
	$__GNUC_PREREQ
 (3,2)

641 #i‡!
deföed
 
_FORCE_INLINES
 && !deföed 
_HAVE_STRING_ARCH_memp˝y


643 #unde‡
memp˝y


644 #unde‡
__memp˝y


645 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y_ölöe
 (de°, src,Ç)

	)

646 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y_ölöe
 (de°, src,Ç)

	)

648 
__exã∫_Æways_ölöe
 *

649 
	$__memp˝y_ölöe
 (*
__ª°ri˘
 
__de°
,

650 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

652  (*Ë
	`mem˝y
 (
__de°
, 
__§c
, 
__n
) + __n;

653 
	}
}

658 
	g__END_DECLS


	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #unde‡
__USE_ISOC11


98 #unde‡
__USE_ISOC99


99 #unde‡
__USE_ISOC95


100 #unde‡
__USE_ISOCXX11


101 #unde‡
__USE_POSIX


102 #unde‡
__USE_POSIX2


103 #unde‡
__USE_POSIX199309


104 #unde‡
__USE_POSIX199506


105 #unde‡
__USE_XOPEN


106 #unde‡
__USE_XOPEN_EXTENDED


107 #unde‡
__USE_UNIX98


108 #unde‡
__USE_XOPEN2K


109 #unde‡
__USE_XOPEN2KXSI


110 #unde‡
__USE_XOPEN2K8


111 #unde‡
__USE_XOPEN2K8XSI


112 #unde‡
__USE_LARGEFILE


113 #unde‡
__USE_LARGEFILE64


114 #unde‡
__USE_FILE_OFFSET64


115 #unde‡
__USE_MISC


116 #unde‡
__USE_ATFILE


117 #unde‡
__USE_GNU


118 #unde‡
__USE_REENTRANT


119 #unde‡
__USE_FORTIFY_LEVEL


120 #unde‡
__KERNEL_STRICT_NAMES


124 #i‚de‡
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

137 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

146 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

147 && !
deföed
 
	g_DEFAULT_SOURCE


152 #unde‡
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifde‡
_GNU_SOURCE


158 #unde‡
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #unde‡
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #unde‡
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #unde‡
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #unde‡
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #unde‡
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #unde‡
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #unde‡
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #unde‡
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #unde‡
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

183 || (!
deföed
 
	g__STRICT_ANSI__
 \

184 && !
deföed
 
	g_ISOC99_SOURCE
 \

185 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

186 && !
deföed
 
	g_XOPEN_SOURCE
))

187 #unde‡
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #i‡(
deföed
 
_ISOC11_SOURCE
 \

193 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

199 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

205 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

214 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifde‡
_DEFAULT_SOURCE


222 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #unde‡
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #unde‡
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #i‡((!
deföed
 
__STRICT_ANSI__
 \

231 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #i‡(
deföed
 
_POSIX_SOURCE
 \

247 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
deföed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #unde‡
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #unde‡
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #unde‡
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #unde‡
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

286 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #unde‡
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #unde‡
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifde‡
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifde‡
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifde‡
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #i‡
deföed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #i‡
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<°dc-¥edef.h
>

353 #unde‡
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

362 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

365 #i‚de‡
__ASSEMBLER__


366 #i‚de‡
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

381 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

382 && 
deföed
 
	g__exã∫_ölöe


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/°ubs.h
>

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
21
241
elf64.c
gdt.c
idt.c
kb.c
kprintf.c
kprintf_1.c
main.c
paging.c
paging_helper.c
pic.c
picassem.c
process.c
string.c
tarfs.c
timer.c
utils.c
vma.c
/usr/include/string.h
/usr/include/features.h
/usr/include/xlocale.h
/usr/include/stdc-predef.h
